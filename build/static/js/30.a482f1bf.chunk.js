(this["webpackJsonptickt-web"]=this["webpackJsonptickt-web"]||[]).push([[30],{304:function(e,t,a){"use strict";t.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFVSURBVHgB7ZTPTcMwFMbfswTqn0tG6AhhA6cT9ATKjUwATECYoGKC9kbLhQ2oN6AjZAQfaFRU4YedJlUIjmOExKHqJ0WKbL/f5/fZMsBJRy+0Dfb54gYZ8nOVJ1Ik0gXo8acRY2zKlHp8F7FozjOrq4Yj0WSHg1XAZ4ETjrgya4nRxLbGaqCUuiOADIDCNpMDHGCkt7Q+Ux+pjWWNyAqgPKri+j4H2SdRtBVxBr4dGJkCpQvrnZhx040v3NmBtROEORCGxtAH7mXww2QvL7gRAw/1YCsRUNa2JXzg3gY77L9UsehPAsH1cLyY+dR2GpQgDmUsQCyqTAbj5X1XPXbCNQgamQ/5cwiozK0KCDHNX68efm1Qg0sNv2hmXpq8mX+XCbPDl9MKbiKxHehGXK6BKCl2SZTq9+vW24D217GAF6AWbUQ8P5gAtb5ZVrkeub+sPen/9QVDS7zkZB34uAAAAABJRU5ErkJggg=="},312:function(e,t,a){"use strict";t.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAW0lEQVRIS2NkoDFgpLH5DMPMAm7HFf+pEWRf90fAQwYliGhuATVcj27GMIvk4RtEpKYunMkUVxDR3AJK4mY0mRIMPfoGEampBZfzR0tTghGLrIC+kUyS04hUDAD9mBgZUEFJtQAAAABJRU5ErkJggg=="},396:function(e,t,a){"use strict";t.a=a.p+"static/media/not-found.c5fd5f1f.png"},599:function(e,t,a){"use strict";a.r(t);var n=a(37),i=a(45),s=a(41),o=a(2),c=a.n(o),r=a(12),l=a(17),d=a(0),u=a(76),m=a(312),v=a(304),j=a(4),A=a(53),b=a(66),p=a(42),g=a(6),O=a(221),f=a(20),h=a(396),x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAA8CAYAAAAZp4inAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHpSURBVHgB1Zr/UcJAEIVfHAuwhKMD6UA60AqUDrQCsQQrkA6kA9KBdJDrQDpYd03Qm0zQS3I/9r6Z/SMMwzzefAkXckAHEV3zvPF8UstHd2ygFQ53T+dp5EtBG9Io+fEMTXQ6+PKuRh3HaV8a0qAOTSevOjSPfOrQfBrKoQ6FI606FJZ06lB4GkqgzgXCY3hkuRBXHYpLNHUq+XTExfLcVVV1QEBiqNLHIIY6lJZg6qRQpY9FAHVSqNLHIIA6ORp32fE8cfsWI8kdXLCYoE4OVfoYTFBHQ+Mu3upoCy5YeKijQZU+Bh7qaGzc5aw62oMLFgPqaFSlj8GAOiU07iLqrLn9Y2nBhZqDr0oMLqxLDV6XcHIOYUoNfiw1+KFUxxclNi7XcVtScMuz4tBbOSgl+AvPkkPXpxcuoRtZWK2H1uZaGz+iXc4uz91QaGy8RncC/vUmTY2fWl753HNqabyGR8suuRsf1bJLzsZ/bgowgRzBJagE3mEGqVV55VnMDS2katyibblGIFI0Li0vQ4b+huLR8NwgFhSHDc8VYkJhkT9u0jzXpzDInpcNUkLz2VOOrR80HWn5Ebmg8Vub8rXcC74fEThvyy7UbpT0QZ4Kx73EjYUDPfzT8i20Qu3GyS39Ot9Qih+SiXwBkwmQStsXLyMAAAAASUVORK5CYII=",N=a(93),I=a(25),U=a(19),w=a(262),k=a.n(w),y=a(48),T=a(1),C="",B=["jpeg","jpg","png","mp4","wmv","avi"],D=function(e){var t,a,n,i,o,m,b,w,D,S=Object(d.useRef)(null),E=Object(d.useState)(null===(t=f.a.getItem("userInfo"))||void 0===t?void 0:t._id),R=Object(l.a)(E,1)[0],_=Object(d.useState)(!1),Q=Object(l.a)(_,2),M=Q[0],Y=Q[1],F=Object(d.useState)(!1),z=Object(l.a)(F,2),L=z[0],q=z[1],H=Object(d.useState)(null),K=Object(l.a)(H,2),V=K[0],X=K[1],G=Object(d.useState)(""),Z=Object(l.a)(G,2),P=Z[0],W=Z[1],J=Object(d.useState)([]),$=Object(l.a)(J,2),ee=$[0],te=$[1],ae=Object(d.useState)(!1),ne=Object(l.a)(ae,2),ie=ne[0],se=ne[1],oe=Object(d.useState)([]),ce=Object(l.a)(oe,2),re=ce[0],le=ce[1],de=Object(d.useState)(!1),ue=Object(l.a)(de,2),me=ue[0],ve=ue[1],je=Object(d.useState)(1),Ae=Object(l.a)(je,2),be=Ae[0],pe=Ae[1],ge=Object(d.useState)({}),Oe=Object(l.a)(ge,2),fe=Oe[0],he=Oe[1],xe=Object(d.useState)(""),Ne=Object(l.a)(xe,2);Ne[0],Ne[1];Object(d.useEffect)((function(){""!==e.roomId&&(C="",Object(p.g)(e.roomId,Ue),pe(1),he({}),le([]),X(null),Y(!1))}),[e.roomId]),Object(d.useEffect)((function(){Ie()}));var Ie=function(){if(null!==(null===S||void 0===S?void 0:S.current)){var e=S.current.scrollHeight-S.current.clientHeight;S.current.scrollTo(0,e)}},Ue=function(e){te(e)};Object(d.useEffect)((function(){var e={},t=[],a=1;ee.length&&(t=ee.filter((function(t,n){if("image"===t.messageType||"video"===t.messageType)return e["".concat(n)]=a++,t})),le(t),he(e))}),[ee]);var we=function(t){var a=Object(s.a)(e.inBoxData),n=a.findIndex((function(t){return t.roomId===e.roomId}));a[n].lastMsg=t,a.splice(n,1),a.unshift(e.inBoxData[n]),e.setInBoxData(a)},ke=function(){var t=Object(r.a)(c.a.mark((function t(){var a,n,i,s,o,r,l,d,u,m;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!P||""===P.trimLeft()){t.next=7;break}return W(""),t.next=4,Object(p.m)(e.roomId,P);case 4:(u=t.sent)&&(null===(a=e.roomData)||void 0===a||null===(n=a.oppUserInfo)||void 0===n?void 0:n.deviceToken)&&(null===(i=e.roomData)||void 0===i||null===(s=i.oppUserInfo)||void 0===s?void 0:s.deviceType)&&(!(null===(o=e.roomData)||void 0===o||null===(r=o.oppUserInfo)||void 0===r?void 0:r.hasOwnProperty("isNotification"))||(null===(l=e.roomData)||void 0===l||null===(d=l.oppUserInfo)||void 0===d?void 0:d.isNotification))&&(Be(u),m={timeStamp:y.b.getCurrentTimeStamp()},y.b.moE_SendEvent(U.a.CHAT,m),y.a.mixP_SendEvent(U.a.CHAT,m)),we(u);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ye=function(){var t=Object(r.a)(c.a.mark((function t(a,n){var i,s,o,r,l,d,u,m,v;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a||""===a){t.next=6;break}return t.next=3,Object(p.l)(e.roomId,a,n);case 3:(v=t.sent)&&(null===(i=e.roomData)||void 0===i||null===(s=i.oppUserInfo)||void 0===s?void 0:s.deviceToken)&&(null===(o=e.roomData)||void 0===o||null===(r=o.oppUserInfo)||void 0===r?void 0:r.deviceType)&&(!(null===(l=e.roomData)||void 0===l||null===(d=l.oppUserInfo)||void 0===d?void 0:d.hasOwnProperty("isNotification"))||(null===(u=e.roomData)||void 0===u||null===(m=u.oppUserInfo)||void 0===m?void 0:m.isNotification))&&Be(v),we(v);case 6:W("");case 7:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),Te=function(){var e=Object(r.a)(c.a.mark((function e(t){var a,n,i,s,o,r,l,d,u,m,v;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q(!0),e.next=3,Object(O.F)(t);case 3:(a=e.sent).success&&(v={jobDescription:(null===(n=a.data)||void 0===n?void 0:n.details)||"",jobId:(null===(i=a.data)||void 0===i?void 0:i.jobId)||"",jobName:(null===(s=a.data)||void 0===s?void 0:s.jobName)||"",amount:(null===(o=a.data)||void 0===o?void 0:o.amount)||"",locationName:(null===(r=a.data)||void 0===r?void 0:r.locationName)||"",fromDate:(null===(l=a.data)||void 0===l?void 0:l.fromDate)||"",toDate:(null===(d=a.data)||void 0===d?void 0:d.toDate)||"",duration:(null===(u=a.data)||void 0===u?void 0:u.duration)||"",status:(null===(m=a.data)||void 0===m?void 0:m.status)||""},X(v),q(!1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ce=function(t,a){var n,i,s,o,c,r,l,d,u,m,v,j,A,b,p,g;switch(Number(t)){case 1:return{app_icon:"https://appinventiv-development.s3.amazonaws.com/1628513615740ic-logo-yellow.png",title:"Tickt App",notificationText:"".concat(null===(n=f.a.getItem("userInfo"))||void 0===n?void 0:n.userName," send you a message"),senderName:"".concat(null===(i=f.a.getItem("userInfo"))||void 0===i?void 0:i.userName),messageType:"".concat(null===a||void 0===a?void 0:a.messageType),messageText:"".concat("text"===(null===a||void 0===a?void 0:a.messageType)?null===a||void 0===a?void 0:a.messageText:""),room_id:null===a||void 0===a?void 0:a.messageRoomId,image:null===(s=f.a.getItem("userInfo"))||void 0===s?void 0:s.user_image,notificationType:25,sound:"default"};case 2:return{body:null===a||void 0===a?void 0:a.messageText,messageText:null===a||void 0===a?void 0:a.messageText,sender:{first_name:null===(o=f.a.getItem("userInfo"))||void 0===o?void 0:o.userName,device_token:f.a.getItem("fcmToken"),user_id:null===(c=f.a.getItem("userInfo"))||void 0===c?void 0:c._id,device_type:2},jobId:null===a||void 0===a||null===(r=a.messageRoomId)||void 0===r||null===(l=r.split("_"))||void 0===l?void 0:l[0],badge:1,device_type:2,title:null===(d=f.a.getItem("userInfo"))||void 0===d?void 0:d.userName,jobName:null===(u=e.roomData)||void 0===u?void 0:u.jobName,notification_type:50,sound:"default",messageId:null===a||void 0===a?void 0:a.messageId};case 3:return{notification:{body:null===a||void 0===a?void 0:a.messageText,title:null===(m=f.a.getItem("userInfo"))||void 0===m?void 0:m.userName},data:{body:null===a||void 0===a?void 0:a.messageText,messageText:null===a||void 0===a?void 0:a.messageText,sender:{first_name:null===(v=f.a.getItem("userInfo"))||void 0===v?void 0:v.userName,device_token:f.a.getItem("fcmToken"),user_id:null===(j=f.a.getItem("userInfo"))||void 0===j?void 0:j._id,device_type:2},jobId:null===a||void 0===a||null===(A=a.messageRoomId)||void 0===A||null===(b=A.split("_"))||void 0===b?void 0:b[0],badge:1,device_type:2,title:null===(p=f.a.getItem("userInfo"))||void 0===p?void 0:p.userName,jobName:null===(g=e.roomData)||void 0===g?void 0:g.jobName,notification_type:50,sound:"default",messageId:null===a||void 0===a?void 0:a.messageId}};default:return}},Be=function(){var t=Object(r.a)(c.a.mark((function t(a){var n,i,s,o,r,l,d,u,m,v,j,A,b;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j=Ce(null===(n=e.roomData)||void 0===n||null===(i=n.oppUserInfo)||void 0===i?void 0:i.deviceType,a),A=Object(g.a)(Object(g.a)(Object(g.a)({to:"".concat(null===(s=e.roomData)||void 0===s||null===(o=s.oppUserInfo)||void 0===o?void 0:o.deviceToken)},1==(null===(r=e.roomData)||void 0===r||null===(l=r.oppUserInfo)||void 0===l?void 0:l.deviceType)&&{data:j}),2==(null===(d=e.roomData)||void 0===d||null===(u=d.oppUserInfo)||void 0===u?void 0:u.deviceType)&&{notification:j}),3==(null===(m=e.roomData)||void 0===m||null===(v=m.oppUserInfo)||void 0===v?void 0:v.deviceType)&&{notification:null===j||void 0===j?void 0:j.notification,data:null===j||void 0===j?void 0:j.data}),b={"Content-Type":"application/json",Authorization:U.b.FcmHeaderAuthorizationKey},t.next=5,fetch("https://fcm.googleapis.com/fcm/send",{method:"POST",headers:b,body:JSON.stringify(A)});case 5:200===t.sent.status?console.log("Chat push notification send to opposite user: success"):console.log("Chat push notification send to opposite user: failure");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),De=function(){var e=Object(r.a)(c.a.mark((function e(t){var a,n,i,s,o,r,l,d,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=10,s=new FormData,o=t.target.files[0],r=null===o||void 0===o||null===(a=o.type)||void 0===a||null===(n=a.split("/")[1])||void 0===n?void 0:n.toLowerCase(),l=(null===o||void 0===o?void 0:o.size)/1024/1024,["mp4","wmv","avi"].includes(r)&&(i=20),!(B.indexOf(r)<0||l>i)){e.next=9;break}return Object(j.c)(!0,"The file must be in proper format or size"),e.abrupt("return");case 9:return s.append("file",o),se(!0),d=["jpeg","jpg","png"].includes(r)?1:["mp4","wmv","avi"].includes(r)?2:null,e.next=14,Object(I.l)(s);case 14:(u=e.sent).success&&u.imgUrl&&(1===d?ye(u.imgUrl,"image"):2===d?ye(u.imgUrl,"video"):Object(j.c)(!0,"There is some technical issue"),se(!1));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Se=function(e,t){switch(0===t&&(C=""),e.messageType){case"text":return function(e){var t=Object(A.c)(e.messageTimestamp,"day"),a=e.senderId===R?"message":"message recive_msg";return""===C||C!==t?(C=t,Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("div",{className:"date_time",children:Object(T.jsx)("span",{children:t})}),Object(T.jsx)("div",{className:"".concat(a),children:Object(T.jsxs)("p",{className:"".concat(e.senderId===R?"mark":""),children:[e.messageText,Object(T.jsx)("span",{className:"time",children:Object(A.c)(e.messageTimestamp,"time")})]})})]})):Object(T.jsx)("div",{className:"".concat(a),children:Object(T.jsxs)("p",{className:"".concat(e.senderId===R?"mark":""),children:[e.messageText,Object(T.jsx)("span",{className:"time",children:Object(A.c)(e.messageTimestamp,"time")})]})})}(e);case"image":return function(e,t){var a=Object(A.c)(e.messageTimestamp,"day"),n=e.senderId===R?"message":"message recive_msg";return""===C||C!==a?(C=a,Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("div",{className:"date_time",children:Object(T.jsx)("span",{children:a})}),Object(T.jsx)("div",{className:"".concat(n),children:Object(T.jsxs)("figure",{className:"media",children:[Object(T.jsx)("img",{src:e.mediaUrl||h.a,alt:"media","async-src":e.mediaUrl||h.a,decoding:"async",loading:"lazy",onError:function(e){var t,a;(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.onerror)&&(e.target.onerror=null),(null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.src)&&(e.target.src=h.a)},onClick:function(){ve((function(e){return!e})),pe(fe["".concat(t)])}}),Object(T.jsx)("span",{className:"time",children:Object(A.c)(e.messageTimestamp,"time")})]})})]})):Object(T.jsx)("div",{className:"".concat(n),children:Object(T.jsxs)("figure",{className:"media",children:[Object(T.jsx)("img",{src:e.mediaUrl||h.a,alt:"media","async-src":e.mediaUrl||h.a,decoding:"async",loading:"lazy",onError:function(e){var t,a;(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.onerror)&&(e.target.onerror=null),(null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.src)&&(e.target.src=h.a)},onClick:function(){ve((function(e){return!e})),pe(fe["".concat(t)])}}),Object(T.jsx)("span",{className:"time",children:Object(A.c)(e.messageTimestamp,"time")})]})})}(e,t);case"video":return function(e,t){var a=Object(A.c)(e.messageTimestamp,"day"),n=e.senderId===R?"message":"message recive_msg";return""===C||C!==a?(C=a,Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("div",{className:"date_time",children:Object(T.jsx)("span",{children:a})}),Object(T.jsx)("div",{className:"".concat(n),children:Object(T.jsxs)("figure",{className:"media media_video ",children:[Object(T.jsx)("video",{src:e.mediaUrl||h.a,poster:x,onClick:function(){ve((function(e){return!e})),pe(fe["".concat(t)])}}),Object(T.jsx)("span",{className:"time",children:Object(A.c)(e.messageTimestamp,"time")})]})})]})):Object(T.jsx)("div",{className:"".concat(n),children:Object(T.jsxs)("figure",{className:"media media_video ",children:[Object(T.jsx)("video",{src:e.mediaUrl||h.a,poster:x,onClick:function(){ve((function(e){return!e})),pe(fe["".concat(t)])}}),Object(T.jsx)("span",{className:"time",children:Object(A.c)(e.messageTimestamp,"time")})]})})}(e,t)}},Ee=function(e){var t=[],a=[];return e.length&&e.forEach((function(e){"video"===e.messageType&&(t.push(e.mediaUrl),a.push("video")),"image"===e.messageType&&(t.push(e.mediaUrl),a.push("image"))})),{sources:t,types:a}}(re),Re=Ee.sources,_e=Ee.types;return e.isNoRecords?Object(T.jsx)("div",{className:"detail_col",children:Object(T.jsx)("div",{className:"flex_row",children:Object(T.jsx)("div",{})})}):Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(k.a,{toggler:me,slide:be,sources:Re,types:_e,onClose:function(){pe(1)}},null===Re||void 0===Re?void 0:Re.length),Object(T.jsx)("div",{className:"detail_col",children:Object(T.jsxs)("div",{className:"flex_row",children:[Object(T.jsxs)("div",{className:"chat_col ".concat(M?"active":""),children:[Object(T.jsxs)("div",{className:"chat_user",children:[Object(T.jsx)("figure",{className:"u_img",children:Object(T.jsx)("img",{src:(null===(a=e.roomData)||void 0===a||null===(n=a.oppUserInfo)||void 0===n?void 0:n.image)||u.a,alt:"user-img",onError:function(e){var t,a;(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.onerror)&&(e.target.onerror=null),(null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.src)&&(e.target.src=u.a)}})}),Object(T.jsx)("span",{className:"name",onClick:function(){var t,a,n,i;2===f.a.getItem("userType")?e.history.push("/tradie-info?tradeId=".concat(null===(t=e.roomData)||void 0===t||null===(a=t.oppUserInfo)||void 0===a?void 0:a.userId,"&hideInvite=true")):e.history.push("/builder-info?builderId=".concat(null===(n=e.roomData)||void 0===n||null===(i=n.oppUserInfo)||void 0===i?void 0:i.userId))},children:null===(i=e.roomData)||void 0===i||null===(o=i.oppUserInfo)||void 0===o?void 0:o.name}),!M&&Object(T.jsxs)("span",{onClick:function(){var t;Y(!0),V||Te(null===(t=e.roomData)||void 0===t?void 0:t.jobId)},className:"view_detail",children:["View Job Details",Object(T.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACWSURBVHgB7ZTBDYAgDEWLejBOgZvIGE6oW+gmMoYXxdZwMF7kkxA88C4EQvtIKRAVcqOQzZ2ZNwk4nDP7OtqQmIpwdK3U0g6TDtkMCU4+uSOyiAQqkSBJK07OgZqn9qtcsACVRAkQSbQgVNK8g3wrasK5L57H/rkY06YQyUv0z0tO2qZJHxqaXIC6CE0OCzwW+a4L+bkA+mx0ERNXUvgAAAAASUVORK5CYII=",alt:"view-more"})]})]}),Object(T.jsxs)("div",{className:"message_wrapr",ref:S,children:[ee.length>0&&ee.map((function(e,t){return Se(e,t)})),Object(T.jsx)("div",{className:"date_time",children:(null===(m=e.roomData)||void 0===m||null===(b=m.oppUserInfo)||void 0===b?void 0:b.isBlock)&&Object(T.jsx)("i",{style:{color:"#929292"},children:"You can no longer chat with the user"})})]}),!(null===(w=e.roomData)||void 0===w||null===(D=w.oppUserInfo)||void 0===D?void 0:D.isBlock)&&Object(T.jsx)("div",{className:"send_msg",children:Object(T.jsxs)("div",{className:"text_field",children:[Object(T.jsx)("label",{className:"upload_item",htmlFor:"upload_item",children:Object(T.jsx)("span",{className:"detect_icon_ltr",children:Object(T.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABXUExURUdwTP///////////////////////////////////////wtBqODn9KC13YWg1GaIyWaJyEhwvsLP6RpNrSlZs/Dz+tHb73aUzld8xLPD5DlkubLD5Fd9wl7Mg6UAAAAKdFJOUwDfn6C/cIAcc+/XmZsvAAABPklEQVQ4y5WV7ZpFIBSFOSc87b7sSmHm/q9zImbihGb9iafXqrVjq6qoriU1fIiSpqtSdQQu9U7QhsKNaLNzLTyo3fzgUatnR59BuuzzBQUiwRCK1JXsMOYhZSCpDlEGqaTQbvgE6+pwq2bhv9EyM+P6RDJ1BO02xfUkPc6GWZcH2WnRQdgMOMiRqVQiWLMMqFAeZT3onCNzp6TcwIQ5kO8AzmIdGYjxDrR+MjqCXt6AS4BRxIt1vHQMxTY8gqgvQD2GKe77JRdXDIzLg94IYcRWVdOz5ARSUCMGU2eXANqi5syZ3Fkz42MYqya0X8se9ZwFp72OPcphDSMR7lL/ngwzvAh06cuUgKjEUajSF/evNYXyHSUTQ1r+cbVlYFPeAMrWfv2nSRW3vfJGWt6awz7fNxU8/RcakrGtSbtjP7Y8P8bN8RBFAAAAAElFTkSuQmCC",alt:"media"})})}),Object(T.jsx)("input",{id:"upload_item",className:"hide",type:"file",accept:"image/png,image/jpg,image/jpeg, video/mp4, video/wmv, video/avi",onChange:De,disabled:ie}),Object(T.jsx)("textarea",{placeholder:"Message..",onKeyDown:function(e){e.shiftKey||"Enter"!==e.key||(e.preventDefault(),ke(),W(""))},value:P,onChange:function(e){return W(e.target.value)}}),Object(T.jsx)("span",{className:"detect_icon",children:Object(T.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAnUExURUdwTAtBqApBqApBqAtApwpApwtBqApBqAhApxBAnwlApwtApwtBqA/NXNUAAAAMdFJOUwDBf99gQO+hIBBwkA7bl6QAAACoSURBVBjTY2CAA1ZhBHtSzkE4O/BYzhEok1Pt4OozBlDlMtkBOsoFUOVSE5gO+TRAlG9lYNBREIQoX8nAwHSI4whEOQNIgh2o30ZqAgNIgoEZqN/5eANYggGs3/l4AEiCQRBssPPBAKAEB9R+54NACXao/QzOAgxg/RDXHGWA6AcDQZh+EIgJgOkHAmYBuH4GBpajcP1AYIjQDzQrEcFmYDuCxOEC6wcA6NUlu1h0PO0AAAAASUVORK5CYII=",alt:"send",onClick:ke})})]})})]}),M&&L?Object(T.jsx)("div",{className:"view_detail_col",children:Object(T.jsx)("div",{className:"no_record",children:Object(T.jsx)("figure",{children:Object(T.jsx)("img",{src:N.a,alt:"loader",width:"130px"})})})}):M?Object(T.jsxs)("div",{className:"view_detail_col",children:[Object(T.jsxs)("div",{className:"f_spacebw relative",children:[Object(T.jsx)("span",{className:"title line-2 pr-20",children:null===V||void 0===V?void 0:V.jobName}),Object(T.jsx)("span",{onClick:function(){Y((function(e){return!e}))},className:"close",children:Object(T.jsx)("img",{src:v.a,alt:"close"})})]}),Object(T.jsx)("div",{className:"job_info",children:Object(T.jsxs)("ul",{children:[Object(T.jsx)("li",{className:"icon clock",children:Object(A.h)(null===V||void 0===V?void 0:V.fromDate,null===V||void 0===V?void 0:V.toDate)}),Object(T.jsx)("li",{className:"icon dollar",children:null===V||void 0===V?void 0:V.amount}),Object(T.jsx)("li",{className:"icon location line-1",children:null===V||void 0===V?void 0:V.locationName}),Object(T.jsx)("li",{className:"icon calendar",children:null===V||void 0===V?void 0:V.duration})]})}),Object(T.jsx)("p",{className:"commn_para",children:null===V||void 0===V?void 0:V.jobDescription}),Object(T.jsx)("button",{className:"fill_btn full_btn btn-effect",onClick:function(){if(1===f.a.getItem("userType"))e.history.push("/job-details-page?jobId=".concat(null===V||void 0===V?void 0:V.jobId,"&redirect_from=jobs"));else{var t="?jobId=".concat(null===V||void 0===V?void 0:V.jobId,"&status=").concat(null===V||void 0===V?void 0:V.status,"&edit=true&activeType=active");e.history.push("/job-detail?".concat(t))}},children:"View Job details"})]}):null]})})]})},S="",E=!1,R=function(e){var t,a,n,i,o=Object(d.useState)(!0),g=Object(l.a)(o,2),O=g[0],f=g[1],h=Object(d.useState)((function(){return p.a.currentUser})),x=Object(l.a)(h,2),N=(x[0],x[1]),I=Object(d.useState)([]),U=Object(l.a)(I,2),w=U[0],k=U[1],y=Object(d.useState)([]),C=Object(l.a)(y,2),B=C[0],R=C[1],_=Object(d.useState)(!1),Q=Object(l.a)(_,2),M=Q[0],Y=Q[1],F=Object(d.useState)({}),z=Object(l.a)(F,2),L=z[0],q=z[1],H=Object(d.useState)(""),K=Object(l.a)(H,2),V=(K[0],K[1]),X=Object(d.useState)(""),G=Object(l.a)(X,2),Z=G[0],P=G[1],W=Object(d.useState)(!1),J=Object(l.a)(W,2),$=J[0],ee=J[1],te=Object(d.useState)(!0),ae=Object(l.a)(te,2),ne=ae[0],ie=ae[1],se=Object(d.useState)(!1),oe=Object(l.a)(se,2),ce=oe[0],re=oe[1],le=(null===(t=e.history)||void 0===t||null===(a=t.location)||void 0===a?void 0:a.state)?null===(n=e.history)||void 0===n||null===(i=n.location)||void 0===i?void 0:i.state:{tradieId:"",builderId:"",jobName:"",jobId:""},de=le.tradieId,ue=le.builderId,me=le.jobName,ve=le.jobId;Object(d.useEffect)((function(){return Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(j.a)(!0),!(de&&ue&&me&&ve)){e.next=6;break}return e.next=4,je();case 4:e.next=7;break;case 6:E=!0;case 7:return e.next=9,Object(p.e)(Ae);case 9:case"end":return e.stop()}}),e)})))(),function(){Object(p.o)(S),S=""}}),[]);var je=function(){var e=Object(r.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(ve,"_").concat(de,"_").concat(ue),S=t,e.next=4,Object(p.b)(t);case 4:if(!e.sent){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,Object(p.c)(ve,de,ue,me);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ae=function(){var e=Object(r.a)(c.a.mark((function e(t){var a,n,i,o,r,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="",null===(n=t.filter((function(e,t){if(e.hasOwnProperty("lastMsg")||e.roomId===S){if(e.roomId!==S||E)return e;a=e}})))||void 0===n||n.sort((function(e,t){var a,n;return(null===(a=t.lastMsg)||void 0===a?void 0:a.messageTimestamp)-(null===(n=e.lastMsg)||void 0===n?void 0:n.messageTimestamp)})),0!==n.length||a){e.next=7;break}return Y(!0),ne&&(ie(!1),Object(j.a)(!1)),e.abrupt("return");case 7:if(Y(!1),a&&(i=Object(s.a)(n)).unshift(a),o=Array.isArray(i)&&a?i:n,k(0===o.length?[{firstKey:"emptyRes"}]:o),!(o.length>0&&""===S)){e.next=17;break}return S=o[0].roomId,V(o[0].roomId),o[0]&&(null===(r=o[0])||void 0===r?void 0:r.unreadMessages)>0&&(o[0].unreadMessages=0,Object(p.k)(o[0].roomId)),q(o[0]),e.abrupt("return");case 17:o.length>0&&((l=o.find((function(e){return e.roomId==S})))&&(null===l||void 0===l?void 0:l.unreadMessages)>0&&(l.unreadMessages=0,Object(p.k)(l.roomId)),q(l));case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(d.useEffect)((function(){var e=p.a.onAuthStateChanged((function(e){e?(N(e),re(!1)):(N(!1),re(!0),Object(j.a)(!1),ie(!1)),O&&f(!1)}));return e}),[O]);var be=function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(p.o)(S),S=t.roomId,V(t.roomId),q(t),Object(p.k)(t.roomId);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){var e,t;if(Z){var a=w.filter((function(e){var t,a,n;return null===(t=e.oppUserInfo)||void 0===t||null===(a=t.name)||void 0===a||null===(n=a.toLowerCase())||void 0===n?void 0:n.includes(Z.toLowerCase())}));R(a)}(w.length||"emptyRes"===(null===(e=w[0])||void 0===e?void 0:e.firstKey))&&ne&&("emptyRes"===(null===(t=w[0])||void 0===t?void 0:t.firstKey)&&k([]),Object(j.a)(!1),ie(!1))}),[Z,w]),Object(T.jsx)("div",{className:"app_wrapper",children:Object(T.jsxs)("div",{className:"custom_container",children:[Object(T.jsx)("span",{className:"mob_side_nav",onClick:function(){return re(!0)},children:Object(T.jsx)("img",{src:m.a,alt:"mob-side-nav"})}),Object(T.jsxs)("div",{className:"f_row chat_wrapr h-100",children:[Object(T.jsxs)("div",{className:"side_nav_col ".concat(ce?"active":""),children:[Object(T.jsx)("button",{className:"close_nav",onClick:function(){return re(!1)},children:Object(T.jsx)("img",{src:v.a,alt:"close"})}),Object(T.jsxs)("div",{className:"stick",children:[Object(T.jsx)("span",{className:"title",style:{marginLeft:"50px"},children:"Chat"}),Object(T.jsxs)("div",{className:"search_bar ".concat($?"active":""),onClick:function(){ee(!0)},children:[Object(T.jsx)("input",{type:"text",placeholder:"Search",value:Z,onChange:function(e){return P(e.target.value.trimLeft())}}),Object(T.jsx)("span",{className:"detect_icon_ltr",children:Object(T.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAMAAADyHTlpAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABUUExURUdwTPLy8vHx8e/v7/Hx8e/v7+/v7+/v7+/v7/Dw8PPz8/Hx8e/v7/////n5+fPz9BIOJIiGkU1KW3FufMnIzSAdMeLh5C8sP1xZaJeVnz47TaalreepWhcAAAANdFJOUwC/32CaEIBAJHB/71CwYgcnAAABbklEQVQ4y52V25aDIAxFRUShKkFQ8fL//znQWg0otp08qEv3OhwDSbIsCsapKEvRVNl9MEFqkD4AgFCeBCvisHYPhxfXMCsAcW/6Cq7yE/iE85NpAZekF36E5APaZITsHelYgXzeko7d/fJc3qMyZxtafCAdW2yieHmYjdbdmLCARedBWb0oZSJYkljUqKl3t7FTNmLBu6UH2qlue+oHHcn6hJF9/VGZw4nqzw4O0VWhVWPZmuH0Twv6ZIbILM+aA9VYqFORWZoJ+Z2q+69SIiGUtyVOQYnRfs+Vf15PKDLQTnuGRmvbkwGKULDD/NK0KMXbtyY8LKNW1nTGX5GZ94FhdfBmnQY16BnQJm9osLFhhOxzY0XqYAcsUN8qkoWFWXi2DiLTbB9WzE299qHoL2WYsc/FzX9vGb653ZIlblolfEt6Ntk0xf9bsWsd1w2eXU4DB2PajRmSHkmcEjeFXtOoJoJ9mF1V40cc5SfuDwSERuTh1ludAAAAAElFTkSuQmCC",alt:"search"})})]}),Object(T.jsx)("ul",{className:"chat_list",children:Z?0===B.length?Object(T.jsx)("li",{children:Object(T.jsx)("a",{href:"javascript:void(0)",className:"chat",children:Object(T.jsx)("div",{className:"detail",children:Object(T.jsx)("span",{className:"inner_title line-1",children:"No Record Found"})})})}):B.map((function(e){var t,a,n,i,s;return Object(T.jsx)("li",{onClick:function(){be(e)},children:Object(T.jsxs)("a",{href:"javascript:void(0)",className:"chat ".concat(S===e.roomId?"active":""),children:[Object(T.jsx)("figure",{className:"u_img",children:Object(T.jsx)("img",{src:(null===(t=e.oppUserInfo)||void 0===t?void 0:t.image)||u.a,alt:"img",onError:function(e){var t,a;(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.onerror)&&(e.target.onerror=null),(null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.src)&&(e.target.src=u.a)}})}),Object(T.jsxs)("div",{className:"detail",children:[Object(T.jsx)("span",{className:"inner_title line-1",children:null===(a=e.oppUserInfo)||void 0===a?void 0:a.name}),Object(T.jsx)("span",{className:"inner_title job line-1",children:e.jobName}),Object(T.jsx)("p",{className:"commn_para line-1",children:null===(n=e.lastMsg)||void 0===n?void 0:n.messageText}),(null===(i=e.lastMsg)||void 0===i?void 0:i.messageTimestamp)&&Object(T.jsx)("span",{className:"date_time",children:Object(A.c)(null===(s=e.lastMsg)||void 0===s?void 0:s.messageTimestamp,"inboxTime")}),S===e.roomId||0===e.unreadMessages?null:Object(T.jsx)("span",{className:"count",children:e.unreadMessages})]})]})})})):(null===w||void 0===w?void 0:w.length)>0?w.map((function(e){var t,a,n,i,s,o,c,r;return Object(T.jsx)("li",{onClick:function(){be(e)},children:Object(T.jsxs)("a",{href:"javascript:void(0)",className:"chat ".concat(S===e.roomId?"active":""),children:[Object(T.jsx)("figure",{className:"u_img",children:Object(T.jsx)("img",{src:(null===(t=e.oppUserInfo)||void 0===t?void 0:t.image)||u.a,alt:"img",onError:function(e){var t,a;(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.onerror)&&(e.target.onerror=null),(null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.src)&&(e.target.src=u.a)}})}),Object(T.jsxs)("div",{className:"detail",children:[Object(T.jsx)("span",{className:"inner_title line-1",children:null===(a=e.oppUserInfo)||void 0===a?void 0:a.name}),Object(T.jsx)("span",{className:"inner_title job line-1",children:e.jobName}),Object(T.jsx)("p",{className:"commn_para line-1",children:"text"===(null===(n=e.lastMsg)||void 0===n?void 0:n.messageType)?null===(i=e.lastMsg)||void 0===i?void 0:i.messageText:"image"===(null===(s=e.lastMsg)||void 0===s?void 0:s.messageType)?Object(T.jsx)("i",{style:{color:"#929292"},children:"Photo"}):"video"===(null===(o=e.lastMsg)||void 0===o?void 0:o.messageType)?Object(T.jsx)("i",{style:{color:"#929292"},children:"Video"}):""}),(null===(c=e.lastMsg)||void 0===c?void 0:c.messageTimestamp)&&Object(T.jsx)("span",{className:"date_time",children:Object(A.c)(null===(r=e.lastMsg)||void 0===r?void 0:r.messageTimestamp,"inboxTime")}),S===e.roomId||0===e.unreadMessages?null:Object(T.jsx)("span",{className:"count",children:e.unreadMessages})]})]})})})):e.isLoading?null:Object(T.jsx)("li",{children:Object(T.jsx)("a",{href:"javascript:void(0)",className:"chat",children:Object(T.jsx)("div",{className:"detail",children:Object(T.jsx)("span",{className:"inner_title line-1",children:"No Record Found"})})})})})]})]}),ne?null:ne||0!==(null===w||void 0===w?void 0:w.length)?Object(T.jsx)(D,{roomId:S,roomData:L,isNoRecords:M,history:e.history,isLoading:e.isLoading,inBoxData:w,setInBoxData:k}):Object(T.jsx)("div",{className:"detail_col",children:Object(T.jsx)("div",{className:"flex_row tradies_row",children:Object(T.jsxs)("div",{className:"no_record",children:[Object(T.jsx)("figure",{className:"no_img",children:Object(T.jsx)("img",{src:b.a,alt:"data not found"})}),Object(T.jsx)("span",{children:"No Data Found"})]})})})]})]})})},_=Object(n.b)((function(e){return{isLoading:e.common.isLoading,isSkeletonLoading:e.common.isSkeletonLoading}}),(function(e){return Object(i.b)({},e)}))(R);t.default=_}}]);
//# sourceMappingURL=30.a482f1bf.chunk.js.map